<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>客户管理-新建</title>
  <link rel="stylesheet" href="../../css/common.css">
  <link rel="stylesheet" href="../../css/account.css">
  <link rel="stylesheet" href="../../css/table.css">
  <link rel="stylesheet" href="../../css/user.css">
  <link rel="stylesheet" href="../../css/H_user1.css">
  <link rel="stylesheet" href="../../css/z_user.css">


  <link rel="stylesheet" href="../../jedate/skin/jedate.css">
  <link rel="shortcut icon" href="../../images/logo.png"/>
  <script src="../../js/jquery-1.8.0.min.js"></script>
  <script src="../../js/Ajax.js"></script>
  <script src="../../js/js.js"></script>
  <script src='vue1.js'></script>
</head>
<body class="bodycolor">
<div class="wrapper">
    <div class="header"></div>
    <div class="container_user_wrapper">
        <div class="container-left">
          <h3></h3>
          <ul id="left-list"></ul>
        </div>
        <div class="container-right">
            <div class="container-right-main">
                <div class="rtop rtop_edit">
                    <div class="but-box bj-none">
                      <p>
                        <a href="javascript:;" class="back-but" id="backs">返回</a>
                      </p>
                    </div>
                    <div class="userInfobox">
                        <dl>
                            <dt id="user_photo"><img src="" alt=""></dt>
                            <dd>
                                <h3><span id="user_name"></span><span id="user_age"></span></h3>
                                <p id="user_phone"></p>
                            </dd>
                        </dl>
                        <a href="#" class="default_inputbtn see-but" id="see-but">查看病历</a>
                    </div>
                </div><!-- rtop -->
                <div class="add-box-container">
                    <div class="user_main_top" id='app'>
                        <div class="user_topmenu user_topmenu_edit">
                            <ul id='routeUl'>
                                <li><a href="see_info.html#User" id='a1'>基础信息</a></li>
                                <li><a href="see_past.html#User" id='a2'>既往史</a></li>
                                <li><a class="active" href="see_mouths.html#User" id='a3'>口腔情况</a></li>
                                <li><a href="see_tooth.html#User" id='a4'>牙位图</a></li>
                                <li><a href="see_family.html#User" id='a6'>家庭成员</a></li>
                            </ul>

                        </div>
                        <div class="time z_time_edit">
                          <div class="z_time_btn">
                            <p> <b style="display:none;">更新记录：</b>
                                <select name="" id="creat_time" style="display:none;">

                                </select>
                                <!-- 上一次更新时间：<span id="recent_time"></span> -->
                            </p>
                            <label for="">

                                <span  class="default_inputbtn z_edit_btn" id="edit-but" style="display:block">编辑</span>
                                <span  class="default_inputbtn z_add_btn" id="save-but">添加</span>
                            </label>

                          </div>
                        </div>
                        <div class="userContain z_userContain_edit" id="change">
                          <div class="z_userContainMain">

                                <div class="containb_right">
                                    <div class="H_content">
                                      <div class="H_content_title">
                                        <span class="H_title_span" v-cloak>{{data_son.teeth[0].name}}</span>
                                      </div>

                                      <div class="H_content_list">
                                        <div class="H_small_box" id='H_teeth'>

                                          <span class="H_content_list_item" v-for='list in data_son.teeth[0].content'>
                                            <input type="checkbox" value="" id={{list.id}} checked={{list.bool}} v-model='list.bool'>
                                            <label for={{list.id}}><i v-cloak>&nbsp;{{list.name}}</i></label>

                                            <span class="H_content_list_item_space">个数</span>
<<<<<<< .mine
                                            <input type="text" value={{list.sum}} v-model='list.sum' v-cloak disabled={{list.bool?false:true}}>
=======
                                            <input type="text" value={{list.bool?list.sum:''}} v-model='list.sum' v-cloak disabled>
>>>>>>> .r14387
                                          </span>


                                        </div>
                                      </div>

                                      <div class="H_content_title">
                                        <span class="H_title_span H_title_color2">牙周</span>
                                      </div>

                                      <div class="H_content_list" id='teeth_around'>
                                        <div class="H_small_box H_margin_bottom20" v-for='items in data_son.teeth_around'>
                                          <span class="H_content_radio_title" v-cloak>{{items.name}}</span>
                                          <span class="H_content_list_item H_content_list_item_radio" v-for='item_son in items.choose'>
                                            <input type="radio" id={{item_son.id}} value={{item_son.count}} class="radio radio2" name={{items.id}} checked={{items.bool==item_son.count?true:false}} v-model='items.bool' disabled>
                                            <label for={{item_son.id}} ><i v-cloak>&nbsp;{{item_son.name}}</i></label>
                                          </span>
                                        </div> 
                                        <div class="H_small_box" v-show='data_son.teeth_around.length==0?true:false'>没有数据了</div>
                                      </div>


                                      <div class="H_content_title">
                                        <span class="H_title_span H_title_color3">粘膜</span>
                                      </div>

                                      <div class="H_content_list">
                                        <div class="H_small_box" id='H_mucosa'>
                                          <span class="H_content_list_item H_margin_bottom_none H_margin_right" v-for='i in data_son.mucosa'>
                                            <input type="checkbox" disabled value="" id={{i.id}} checked={{i.bool}} v-model='i.bool'>
                                            <label for={{i.id}}><i v-cloak>&nbsp;{{i.name}}</i></label>
                                          </span>

                                        </div>
                                        <div class="H_small_box" v-show='data_son.mucosa.length==0?true:false'>没有数据了</div>
                                      </div>
                                      

                                      <div class="H_content_title">
                                        <span class="H_title_span H_title_color4">外科</span>
                                      </div>

                                      <div class="H_content_list">

                                        <div class="H_small_box H_margin_bottom20" v-for='items2 in data_son.surgery'>
                                          <span class="H_content_radio_title" v-cloak>{{items2.name}}</span>
                                          <span class="H_content_list_item H_content_list_item_radio" v-for='item_son in items2.choose'>
                                            <input disabled type="radio" id={{item_son.id}} value={{item_son.count}} class="radio radio2" name={{items2.id}} checked={{items2.bool==item_son.count?true:false}} v-model='items2.bool'>
                                            <label for={{item_son.id}} ><i v-cloak>&nbsp;{{item_son.name}}</i></label>
                                          </span>
                                        </div>
                                        <div class="H_small_box" v-show='data_son.surgery.length==0?true:false'>没有数据了</div>

                                      </div>

                                      <div class="H_content_title">
                                        <span class="H_title_span H_title_color5">牙病治疗及修复史</span>
                                      </div>

                                      <div class="H_content_list" id='surveyhide' style="display:none;">
                                        <div class="H_small_box">
                                          <span class="H_content_list_item H_margin_bottom_none padding_left0">
                                            治疗及修复史

                                            <textarea disabled class="teeth_repair_textarea" v-model='data_son.teeth_repair' v-cloak>{{data_son.teeth_repair}}</textarea>
                                          </span>
                                        </div>
                                        <div class="H_small_box H_small_box_show" style="display:none;">没有数据了</div>
                                      </div>

                                    </div>
                                </div>

                          </div>
                            <div class="clear"></div>
                        </div>

                    </div>
                </div><!-- add-box-container -->
            </div><!-- container-right-main -->
        </div><!-- container-right -->
    </div>
</div>


<div class="opacity-tip" style="display:none"><p></p></div>
<div class="new-create-opcity" style="display:none">
    <div class="new-uppic-bj">
        <div class="new-uppic-box">
            <h4 class="toph4 nomargin">上传Logo<span class="close_dialog"></span></h4>
            <div class="imageBox">
                <div class="thumbBox"></div>
                <div class="spinner" style="display: none">Loading...</div>
            </div>

            <div class="action">
                <div class="filebut"><input type="file" id="file" class="choose-file"> 上传Logo</div>
                <div class="zoom-box">
                    <span id="btnZoomOut" class="btnZoomOut"></span>
                    <span id="btnZoomIn" class="btnZoomIn"></span>
                </div>
                <input type="button" id="btnCrop" value="确认上传" class="btnCrop">
            </div><!--
            <div class="cropped"></div> -->
        </div>
    </div>
</div>
</body>
<script type="text/javascript">



            $('.userContain').height( $(window).height()-260 )
            window.onresize=function(){
              $('.userContain').height( $(window).height()-260 )
            }
            $('#a3').addClass('active').parent().siblings().children().removeClass('active');
            $('#change div.containb_right').eq(2).show().siblings().hide();
            var user_id = sessionStorage.getItem('user_id');
            var userObj = JSON.parse(sessionStorage.getItem('getOneobj'));
            $('#user_name').html(userObj.user_name);
            $('#user_age').html(userObj.user_age);
            $('#user_phone').html(userObj.user_phone);
            $('#user_photo img').attr('src',userObj.user_photo);
            $('#backs').click(function(){
              window.location.href = '../../index.html#User';
            })
            //创建默认数据 显示出来
            var v1 = new Vue({
              el: '#app',
              data: {
                // data_son:{

                //     "teeth":[
                //       {
                //         name:'牙体',
                //         content:[
                //           {
                //             bool:false,
                //             sum:'',
                //             name:'楔状缺损',
                //             id:'H_content_list_item_1'
                //           },
                //           {
                //             bool:false,
                //             sum:'',
                //             name:'形态异常',
                //             id:'H_content_list_item_2'

                //           },
                //           {
                //             bool:false,
                //             sum:'',
                //             name:'龋齿',
                //             id:'H_content_list_item_3'

                //           },
                //           {
                //             bool:false,
                //             sum:'',
                //             name:'缺失牙',
                //             id:'H_content_list_item_4'

                //           },
                //           {
                //             bool:false,
                //             sum:'',
                //             name:'萌生异常',
                //             id:'H_content_list_item_5'

                //           },
                //           {
                //             bool:false,
                //             sum:'',
                //             name:'多生牙',
                //             id:'H_content_list_item_6'

                //           },
                //           {
                //             bool:false,
                //             sum:'',
                //             name:'牙体发育异常',
                //             id:'H_content_list_item_7'

                //           },
                //           {
                //             bool:false,
                //             sum:'',
                //             name:'牙齿表面缺损',
                //             id:'H_content_list_item_8'

                //           },
                //           {
                //             bool:false,
                //             sum:'',
                //             name:'隐裂',
                //             id:'H_content_list_item_9'

                //           }
                //         ]
                //       }
                //     ],
                //     "teeth_around":[
                //       {
                //         name:'牙石',
                //         id:'H_teeth_roundt1',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'Ⅰ',
                //             id:'H_content_list_item_t10',
                //             count:1
                //           },
                //           {
                //             name:'Ⅱ',
                //             id:'H_content_list_item_t11',
                //             count:2
                //           },
                //           {
                //             name:'Ⅲ',
                //             id:'H_content_list_item_t12',
                //             count:3
                //           }
                //         ]
                //       },
                //       {
                //         name:'松动',
                //         id:'H_teeth_roundt2',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'Ⅰ',
                //             id:'H_content_list_item_t13',
                //             count:1
                //           },
                //           {
                //             name:'Ⅱ',
                //             id:'H_content_list_item_t14',
                //             count:2
                //           },
                //           {
                //             name:'Ⅲ',
                //             id:'H_content_list_item_t15',
                //             count:3
                //           }
                //         ]
                //       },
                //       {
                //         name:'出血',
                //         id:'H_teeth_roundt3',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'Ⅰ',
                //             id:'H_content_list_item_t16',
                //             count:1
                //           },
                //           {
                //             name:'Ⅱ',
                //             id:'H_content_list_item_t17',
                //             count:2
                //           },
                //           {
                //             name:'Ⅲ',
                //             id:'H_content_list_item_t18',
                //             count:3
                //           },
                //           {
                //             name:'IV',
                //             id:'H_content_list_item_t19',
                //             count:4
                //           },
                //           {
                //             name:'V',
                //             id:'H_content_list_item_t20',
                //             count:5
                //           }
                //         ],
                //       }
                //     ],
                //     "mucosa":[
                //       {
                //         name:'正常',
                //         bool:false,
                //         id:'H_content_list_item_21'
                //       },
                //       {
                //         name:'白色斑块',
                //         bool:false,
                //         id:'H_content_list_item_22'
                //       },
                //       {
                //         name:'红色斑块',
                //         id:'H_content_list_item_23',
                //         bool:false
                //       },
                //       {
                //         name:'扁平苔藓',
                //         id:'H_content_list_item_24',
                //         bool:false
                //       },
                //       {
                //         name:'溃疡',
                //         id:'H_content_list_item_25',
                //         bool:false
                //       },
                //       {
                //         id:'H_content_list_item_26',
                //         name:'其他',
                //         bool:false
                //       }
                //     ],
                //     "surgery":[
                //       {
                //         name:'开口度',
                //         id:'H_teeth_roundt4',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'三指宽度',
                //             id:'H_content_list_item_t27',
                //             count:1
                //           },
                //           {
                //             name:'两指宽度',
                //             id:'H_content_list_item_t28',
                //             count:2
                //           },
                //           {
                //             name:'一指宽度，甚至更小',
                //             id:'H_content_list_item_t29',
                //             count:3
                //           }
                //         ]
                //       },
                //       {
                //         name:'开口型',
                //         id:'H_teeth_roundt5',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'直线',
                //             id:'H_content_list_item_t30',
                //             count:1
                //           },
                //           {
                //             name:'左偏',
                //             id:'H_content_list_item_t31',
                //             count:2
                //           },
                //           {
                //             name:'右偏',
                //             id:'H_content_list_item_t32',
                //             count:3
                //           }
                //         ]
                //       },
                //       {
                //         name:'面型',
                //         id:'H_teeth_roundt6',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'大致对称',
                //             id:'H_content_list_item_t33',
                //             count:1
                //           },
                //           {
                //             name:'不对称',
                //             id:'H_content_list_item_t34',
                //             count:2
                //           }
                //         ]
                //       },
                //       {
                //         name:'',
                //         id:'H_teeth_roundt7',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'直面型',
                //             id:'H_content_list_item_t35',
                //             count:1
                //           },
                //           {
                //             name:'凹面型',
                //             id:'H_content_list_item_t36',
                //             count:2
                //           },
                //           {
                //             name:'凸面型',
                //             id:'H_content_list_item_t37',
                //             count:3
                //           }
                //         ]
                //       },
                //       {
                //         name:'牙列',
                //         id:'H_teeth_roundt8',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'拥挤',
                //             id:'H_content_list_item_t38',
                //             count:1
                //           },
                //           {
                //             name:'间隙',
                //             id:'H_content_list_item_t39',
                //             count:2
                //           }
                //         ]
                //       },
                //       {
                //         name:'磨牙关系',
                //         id:'H_teeth_roundt9',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'Ⅰ',
                //             id:'H_content_list_item_t40',
                //             count:1
                //           },
                //           {
                //             name:'Ⅱ',
                //             id:'H_content_list_item_t41',
                //             count:2
                //           },
                //           {
                //             name:'Ⅲ',
                //             id:'H_content_list_item_t42',
                //             count:3
                //           }
                //         ]
                //       },
                //       {
                //         name:'前牙关系',
                //         id:'H_teeth_roundt10',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'反合',
                //             id:'H_content_list_item_t43',
                //             count:1
                //           },
                //           {
                //             name:'开合',
                //             id:'H_content_list_item_t44',
                //             count:2
                //           },
                //           {
                //             name:'深覆盖',
                //             id:'H_content_list_item_t45',
                //             count:3
                //           },
                //           {
                //             name:'深覆合',
                //             id:'H_content_list_item_t46',
                //             count:4
                //           },
                //         ]
                //       },
                //       {
                //         name:'上中线',
                //         id:'H_teeth_roundt11',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'偏左',
                //             id:'H_content_list_item_t47',
                //             count:1
                //           },
                //           {
                //             name:'偏右',
                //             id:'H_content_list_item_t48',
                //             count:2
                //           }
                //         ]
                //       },
                //       {
                //         name:'下中线',
                //         id:'H_teeth_roundt12',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'反合',
                //             id:'H_content_list_item_t49',
                //             count:1
                //           },
                //           {
                //             name:'开合',
                //             id:'H_content_list_item_t50',
                //             count:2
                //           }
                //         ]
                //       },
                //       {
                //         name:'系带',
                //         id:'H_teeth_roundt13',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'反唇系带过低',
                //             id:'H_content_list_item_t51',
                //             count:1
                //           },
                //           {
                //             name:'舌系带过低',
                //             id:'H_content_list_item_t52',
                //             count:2
                //           }
                //         ]
                //       },
                //       {
                //         name:'其他',
                //         id:'H_teeth_roundt14',
                //         bool:'',
                //         choose:[
                //           {
                //             name:'关节弹响',
                //             id:'H_content_list_item_t53',
                //             count:1
                //           }
                //         ]
                //       }
                //     ],
                //     "teeth_repair":''
                // }
                data_son:{

                }
              }
            });
            //判断此id 以前有没有口腔情况数据
            AjaxObj.UsersltDateRecords(function(model){

              //如果有数据
              if(model.Data.data.length !=0){
                $('#recent_time').html(model.Data.data[0].create_time);
                for(var h=0;h<model.Data.data.length;h++){
                  $('#creat_time').append('<option>'+model.Data.data[h].create_time+'</option>');
                  $("#creat_time").change(function(){
                    var create_time = $(this).find("option:selected").text();
                    AjaxObj.UsersltArchives(function(model){
                      var cnt = model.Data.teeth[0].content;
                      var rnd = model.Data.teeth_around;
                      var moc = model.Data.mucosa;
                      var sur = model.Data.surgery;
                      for(var i=0;i<cnt.length;i++){
                        if(cnt[i].bool==false){
                          cnt.splice(i,1);
                          --i;
                        }
                      }
                      for(var i=0;i<rnd.length;i++){
                        if(rnd[i].bool == ''){
                          rnd.splice(i,1);
                          --i;
                        }
                      }
                      for(var i=0;i<moc.length;i++){
                        if(moc[i].bool == false){
                          moc.splice(i,1);
                          --i;
                        }
                      }
                      for(var i=0;i<sur.length;i++){
                        if(sur[i].bool == ''){
                          sur.splice(i,1);
                          --i;
                        }
                      }
                      if(model.Data.teeth_repair == ''){
                        $('#surveyhide').show();
                        $('#surveyhide .H_small_box').hide();
                        $('#surveyhide .H_small_box_show').show();
                      }else{
                        $('#surveyhide').show();
                      }
                      v1.data_son = model.Data;
                    },user_id,create_time,2)
                  });
                }

                AjaxObj.UsersltArchives(function(model){
<<<<<<< .mine
                  for(var i = 0;i<model.Data.teeth[0].content.length;i++){
                    if(model.Data.teeth[0].content[i].bool == false){
                      model.Data.teeth[0].content.splice(i,1);
                      i--;
                      console.log(1111111);
                    }
                  }
                  // for(var j = 0;j<model.Data)
=======
                  var cnt = model.Data.teeth[0].content;
                  var rnd = model.Data.teeth_around;
                  var moc = model.Data.mucosa;
                  var sur = model.Data.surgery;
                  for(var i=0;i<cnt.length;i++){
                    if(cnt[i].bool==false){
                      cnt.splice(i,1);
                      --i;
                    }
                  }
                  for(var i=0;i<rnd.length;i++){
                    if(rnd[i].bool == ''){
                      rnd.splice(i,1);
                      --i;
                    }
                  }
                  for(var i=0;i<moc.length;i++){
                    if(moc[i].bool == false){
                      moc.splice(i,1);
                      --i;
                    }
                  }
                  for(var i=0;i<sur.length;i++){
                    if(sur[i].bool == ''){
                      sur.splice(i,1);
                      --i;
                    }
                  }
                  if(model.Data.teeth_repair == ''){
                    $('#surveyhide').show();
                    $('#surveyhide .H_small_box').hide();
                    $('#surveyhide .H_small_box_show').show();
                  }else{
                    $('#surveyhide').show();
                  }
>>>>>>> .r14387
                  v1.data_son = model.Data;
                  console.log(model.Data)
                },user_id,model.Data.data[0].create_time,2)
                $('#creat_time').siblings('b').show();
                $('#creat_time').show();
              }else{
                
                $('#edit-but').hide();
                
              }

          },user_id,2)

          $('#change input').attr('readonly','true');

          $('#edit-but').click(function(){
            var create_time = $('#creat_time').find("option:selected").text();
            sessionStorage.setItem('create_time',create_time);
            sessionStorage.setItem('fromwhere','see_mouths');
            window.location.href = './edit_mouths.html';
          })
          $('#save-but').click(function(){
            sessionStorage.setItem('create_time','nodata');
            sessionStorage.setItem('fromwhere','see_mouths');
            window.location.href = './edit_mouths.html';
          })
</script>
</html>
